<h1>MyPage</h1>

<% if @user.image? %>                                                              
    <%= image_tag @user.image.url, class: "rounded-circle", size: "150x150" %>
<% else %>
    <%= image_tag "default.jpg", size: "150x150" %>
<% end %>

<p>名前 : <%= @user.name %></p>
<br>
<p>メールアドレス : <%= @user.email %></p>
<br>
<p>プロフィール : <%= @user.profile %></p>
<br>


<%= link_to 'New Task', new_blog_path %>

<p id="notice"><%= notice %></p>


<%= month_calendar events: @user.blogs do |date, post| %>
    <%= date.day %>

    <% post.each do |post| %>
    <div>
        <%= link_to post.title, post %>
        <%= post.start_time.strftime("%H:%M") %>
    </div>
    <% end %>
<% end %>

<div class="wrapper">

    <div id="b" class="area">
        <h2>公開</h2>
        <ul>
            <% @user.blogs.each do |t| %>
                <% if t.release == "公開" %> 
                    <div class="blog">
                        <li><%= t.title %><%= t.start_time.strftime("%H:%M") %></li>
                    </div>
                <% end %>
            <% end %>
        </ul>
    </div>


    <div id="a" class="area">
        <h2>非公開</h2>
        <ul>
            <% @user.blogs.each do |t| %>
                <% if t.release == "非公開" %> 
                    <div class="blog">
                        <li><%= t.title %><%= t.start_time.strftime("%H:%M") %></li>
                    </div>
                <% end %>
            <% end %>
        </ul>
    </div>
</div>

<script>
    function GethashID (hashIDName){
        if(hashIDName){
            $('.tab li').find('a').each(function() {
                var idName = $(this).attr('href');
                if(idName == hashIDName){ 
                    var parentElm = $(this).parent();
                    $('.tab li').removeClass("active");
                    $(parentElm).addClass("active");
                    $(".area").removeClass("is-active");
                    $(hashIDName).addClass("is-active"); 
                }
            });   
        }
    }

    $('.tab a').on('click', function() {
        var idName = $(this).attr('href');
        GethashID (idName);
        return false;
    });

    $(window).on('load', function () {
            $('.tab li:first-of-type').addClass("active");
            $('.area:first-of-type').addClass("is-active");
        var hashName = location.hash;
        GethashID (hashName);
    });
</script>

<% if current_user.id == @user.id %>
    <%= link_to "みんなのカレンダー", blogs_path %>
<% end %>

<% if current_user.id == @user.id %>
    <%= link_to "編集する", edit_user_registration_path %>
<% end %>

<br>
<br>
<br>